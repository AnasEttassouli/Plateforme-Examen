<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Exam</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f4f8; padding: 20px; }
    .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    h1, h2 { color: #013E6D; }
    input, textarea, select, button { width: 100%; padding: 10px; margin-top: 8px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 6px; }
    button { background: #013E6D; color: white; border: none; cursor: pointer; }
    button:hover { background: #012f52; }
    .question { border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-bottom: 15px; background: #f9fafb; }
    .flex { display: flex; gap: 10px; flex-wrap: wrap; }
    .flex input { flex: 1 1 45%; }
    .small-btn { width: auto; padding: 6px 10px; background: #4C4C4C; }
    .small-btn:hover { background: #333; }
    .action-buttons { display: flex; gap: 10px; justify-content: space-between; }
  </style>
</head>
<body>
<div class="container">
  <h1>Create Exam</h1>

  <input id="title" type="text" placeholder="Exam Title">
  <textarea id="description" rows="3" placeholder="Description"></textarea>
  <input id="duration" type="number" placeholder="Duration (minutes)" value="60">
  <input id="targetGroup" type="text" placeholder="Target Group (e.g., Semester 2)">

  <h2>Questions</h2>
  <div id="questions"></div>
  <button onclick="addQuestion()">Add Question</button>

  <div class="action-buttons">
    <button onclick="saveExam()">Save Exam</button>
    <button onclick="goToTakeExam()">Go To Take Exam</button>
  </div>
</div>

<script>
  let questions = [];

  function addQuestion() {
    questions.push({ text: '', type: 'multiple-choice', options: ['', '', '', ''], correctAnswer: [''], points: 1 });
    renderQuestions();
  }

  function updateQuestion(index, field, value) {
    if (field.startsWith('option')) {
      const optionIndex = parseInt(field.split('-')[1]);
      questions[index].options[optionIndex] = value;
    } else if (field === 'correctAnswer') {
      questions[index].correctAnswer = [value];
    } else {
      questions[index][field] = value;
    }
    renderQuestions();
  }

  function deleteQuestion(index) {
    questions.splice(index, 1);
    renderQuestions();
  }

  function renderQuestions() {
    const questionsDiv = document.getElementById('questions');
    questionsDiv.innerHTML = '';

    questions.forEach((q, index) => {
      const questionHTML = document.createElement('div');
      questionHTML.className = 'question';
      questionHTML.innerHTML = `
        <input type="text" placeholder="Question text" value="${q.text}" onchange="updateQuestion(${index}, 'text', this.value)">
        <div class="flex">
          ${q.options.map((opt, i) => `<input type="text" placeholder="Option ${i+1}" value="${opt}" onchange="updateQuestion(${index}, 'option-${i}', this.value)">`).join('')}
        </div>
        <input type="text" placeholder="Correct Answer" value="${q.correctAnswer[0]}" onchange="updateQuestion(${index}, 'correctAnswer', this.value)">
        <input type="number" placeholder="Points" value="${q.points}" onchange="updateQuestion(${index}, 'points', this.value)">
        <button class="small-btn" onclick="deleteQuestion(${index})">Delete</button>
      `;
      questionsDiv.appendChild(questionHTML);
    });
  }

  function saveExam() {
    const examData = {
      title: document.getElementById('title').value.trim(),
      description: document.getElementById('description').value.trim(),
      duration: parseInt(document.getElementById('duration').value) || 60,
      targetGroup: document.getElementById('targetGroup').value.trim(),
      questions: questions
    };

    if (!examData.title || questions.length === 0) {
      alert('Please fill the exam title and add at least one question.');
      return;
    }

    localStorage.setItem('savedExam', JSON.stringify(examData));
    alert('Exam saved locally! Ready for student to take it.');
  }

  function goToTakeExam() {
    window.location.href = 'take-exam.html';
  }
</script>
</body>
</html>
